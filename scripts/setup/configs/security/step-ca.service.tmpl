[Unit]
Description=Step-CA Certificate Authority
Documentation=https://smallstep.com/docs/step-ca
After=network.target
Wants=network.target

[Service]
Type=simple
User=step
Group=step
Environment=STEPPATH=/var/lib/step
ExecStart=/usr/local/bin/step-ca /var/lib/step/config/ca.json --password-file /var/lib/step/secrets/password
Restart=always
RestartSec=10
StandardOutput=journal
StandardError=journal

# Security settings
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/var/lib/step
CapabilityBoundingSet=CAP_NET_BIND_SERVICE
AmbientCapabilities=CAP_NET_BIND_SERVICE

[Install]
WantedBy=multi-user.target
