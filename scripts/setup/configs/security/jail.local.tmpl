# DangerPrep Fail2ban Configuration

[DEFAULT]
# Ban settings
bantime = {{FAIL2BAN_BANTIME}}
findtime = 600
maxretry = {{FAIL2BAN_MAXRETRY}}
backend = systemd

# Email notifications (disabled by default)
destemail = root@localhost
sendername = Fail2Ban
mta = sendmail

# Action
action = %(action_mwl)s

[sshd]
enabled = true
port = {{SSH_PORT}}
filter = sshd
logpath = /var/log/auth.log
maxretry = {{FAIL2BAN_MAXRETRY}}
bantime = {{FAIL2BAN_BANTIME}}

[nginx-http-auth]
enabled = true
filter = nginx-http-auth
logpath = /var/log/nginx/error.log
maxretry = 3
bantime = 3600

[nginx-botsearch]
enabled = true
filter = nginx-botsearch
logpath = /var/log/nginx/access.log
maxretry = 2
bantime = 86400

[recidive]
enabled = true
filter = recidive
logpath = /var/log/fail2ban.log
action = %(action_mwl)s
bantime = 604800  # 1 week
findtime = 86400   # 1 day
maxretry = 5
