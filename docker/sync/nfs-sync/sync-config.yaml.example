# DangerPrep Sync Configuration
sync_config:
  # Central NAS connection
  central_nas:
    host: "100.65.182.27"
    nfs_shares:
      movies: "/mnt/data/polaris/movies"
      tv: "/mnt/data/polaris/tv"
      webtv: "/mnt/data/polaris/webtv"
      books: "/mnt/data/content/books"
  
  # Plex server for metadata
  plex:
    server: "100.65.182.27:32400"
    token: "${PLEX_TOKEN}"  # Set via environment variable
  
  # Local storage paths
  local_storage:
    base_path: "/content"
    max_total_size: "1800GB"  # Leave 200GB free on 2TB drive
  
  # Sync rules by content type
  content_types:
    books:
      type: "full_sync"
      schedule: "0 2 * * *"  # Daily at 2 AM
      local_path: "/content/books"
      nfs_path: "/nfs/books"
      max_size: "50GB"

    movies:
      type: "metadata_filtered"
      schedule: "0 3 * * 0"  # Weekly on Sunday at 3 AM
      local_path: "/content/movies"
      nfs_path: "/nfs/movies"
      max_size: "800GB"
      filters:
        # Simple AND filters (all must match)
        and:
          - type: "year"
            operator: ">="
            value: 2015
          - type: "rating"
            operator: ">="
            value: 7.0
          - type: "resolution"
            operator: "in"
            value: ["1080p", "4K"]
        # OR filters (at least one must match)
        or:
          - type: "genre"
            operator: "in"
            value: ["Action", "Adventure", "Sci-Fi", "Thriller"]
          - type: "director"
            operator: "in"
            value: ["Christopher Nolan", "Quentin Tarantino", "Martin Scorsese"]
        # Complex nested filters
        complex:
          - or:
              - and:
                  - type: "genre"
                    operator: "contains"
                    value: "Comedy"
                  - type: "year"
                    operator: ">="
                    value: 2020
              - and:
                  - type: "rating"
                    operator: ">="
                    value: 6.0
                  - type: "director"
                    operator: "=="
                    value: "Quentin Tarantino"
      priority_rules:
        - type: "year"
          weight: 0.3
        - type: "rating"
          weight: 0.4
        - type: "popularity"
          weight: 0.3
          
    tv:
      type: "folder_filtered"
      schedule: "0 4 * * 0"  # Weekly on Sunday at 4 AM
      local_path: "/content/tv"
      nfs_path: "/nfs/tv"
      max_size: "600GB"
      include_folders:
        # Exact folder names
        - "Breaking Bad"
        - "The Wire"
        - "Stranger Things"
        - "The Office"
        - "Friends"
        - "Game of Thrones"
        - "Better Call Saul"
        - "Westworld"
        - "The Mandalorian"
        - "House of Cards"
        # Wildcard patterns (supports * and ?)
        - "Marvel*"
        - "DC *"
        - "*Documentary*"
        # Subdirectory patterns (include all subdirectories and files)
        - "Comedy Shows/**"
        - "Drama Series/**"
      max_episodes_per_show: 50
      
    webtv:
      type: "folder_filtered"
      schedule: "0 5 * * 0"  # Weekly on Sunday at 5 AM
      local_path: "/content/webtv"
      nfs_path: "/nfs/webtv"
      max_size: "300GB"
      include_folders:
        - "TED Talks"
        - "Documentaries"
        - "Educational"
        - "News Archives"
      
    kiwix:
      type: "kiwix_updater"
      schedule: "0 6 * * 1"  # Weekly on Monday at 6 AM
      local_path: "/content/kiwix"
      max_size: "100GB"
      zim_files:
        - "wikipedia_en_all"
        - "wikipedia_en_medicine"
        - "wiktionary_en_all"
        - "wikivoyage_en_all"
        - "stackoverflow.com_en_all"
        - "gutenberg_en_all"

  # Bandwidth and performance settings
  performance:
    max_concurrent_transfers: 3
    bandwidth_limit: "50MB/s"  # Limit to preserve network for other uses
    retry_attempts: 3
    retry_delay: 300  # 5 minutes
    
  # Logging and monitoring
  logging:
    level: "INFO"
    file: "/app/data/logs/sync.log"
    max_size: "100MB"
    backup_count: 5
    
  # Notifications
  notifications:
    enabled: true
    webhook_url: "${WEBHOOK_URL}"  # Optional webhook for notifications
    email:
      enabled: false  # Enable when internet available
      smtp_server: "smtp.gmail.com"
      smtp_port: 587
      username: "${EMAIL_USERNAME}"
      password: "${EMAIL_PASSWORD}"
      to: "admin@local"
