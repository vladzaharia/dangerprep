# Kiwix Manager Configuration - Example
# Copy this file to config.yaml and customize for your environment

# ============================================================================
# STANDARDIZED SERVICE CONFIGURATION
# These fields are required for all DangerPrep sync services
# ============================================================================

service_name: "kiwix-sync"
version: "1.0.0"
enabled: true
log_level: "info"  # Options: debug, info, warn, error
data_directory: "/app/data"
temp_directory: "/tmp"
max_concurrent_operations: 3  # Range: 1-20
operation_timeout_minutes: 30  # Range: 1-120
health_check_interval_minutes: 5  # Range: 1-60
enable_notifications: true
enable_progress_tracking: true
enable_auto_recovery: true

# ============================================================================
# KIWIX-SPECIFIC CONFIGURATION
# ============================================================================

kiwix_manager:
  # Storage configuration
  storage:
    zim_directory: "/content/kiwix"  # Directory to store ZIM files
    library_file: "/content/kiwix/library.xml"  # Path to Kiwix library file
    temp_directory: "/tmp/kiwix-downloads"  # Temporary directory for downloads
    max_total_size: "100GB"  # Maximum total size for ZIM files

  # Scheduler configuration
  scheduler:
    update_schedule: "0 6 * * *"  # Daily at 6 AM (cron format)
    cleanup_schedule: "0 2 * * 0"  # Weekly cleanup on Sunday at 2 AM (cron format)

  # Download configuration
  download:
    concurrent_downloads: 2  # Number of concurrent downloads (positive integer)
    retry_attempts: 3  # Number of retry attempts (0 or positive)
    retry_delay: 300  # Delay between retries in seconds (positive)
    bandwidth_limit: "25MB/s"  # Bandwidth limit for downloads

  # Logging configuration
  logging:
    level: "INFO"  # Logging level (DEBUG, INFO, WARN, ERROR)
    file: "/app/data/logs/kiwix-manager.log"  # Log file path
    max_size: "50MB"  # Maximum log file size
    backup_count: 3  # Number of backup log files (positive integer)

  # API configuration
  api:
    base_url: "https://library.kiwix.org"  # Base API URL
    catalog_url: "https://library.kiwix.org/catalog/v2/entries"  # Catalog API URL
    timeout: 30000  # API timeout in milliseconds (positive)

  # Mirror configuration for faster downloads
  mirrors:
    # Preferred mirror (tested first)
    preferred: "https://mirrors.dotsrc.org/kiwix/"

    # Available mirrors (tested for speed)
    available:
      - "https://mirrors.dotsrc.org/kiwix/"
      - "https://ftp.fau.de/kiwix/zim/"
      - "https://laotzu.ftp.acc.umu.se/mirror/kiwix.org/zim/"
      - "https://saimei.ftp.acc.umu.se/mirror/kiwix.org/zim/"
      - "https://www.mirrorservice.org/sites/download.kiwix.org/zim/"

    # Fallback to official site
    fallback: "https://download.kiwix.org/zim/"

    # Speed test configuration
    speed_test:
      enabled: true
      test_file_pattern: "wikipedia/speedtest_en_blob_{date}.zim"
      test_timeout: 30  # seconds
      test_size_limit: "10MB"  # Only download first 10MB for speed test
      cache_duration: 86400  # Cache speed test results for 24 hours

  # ZIM files to manage
  zim_files:
    - name: "wikipedia_en_all"
      priority: 1
      auto_update: true
    - name: "wikipedia_en_medicine"
      priority: 2
      auto_update: true
    - name: "wiktionary_en_all"
      priority: 3
      auto_update: true
    - name: "wikivoyage_en_all"
      priority: 4
      auto_update: true
    - name: "stackoverflow.com_en_all"
      priority: 5
      auto_update: true
    - name: "gutenberg_en_all"
      priority: 6
      auto_update: false  # Large file, manual update only
