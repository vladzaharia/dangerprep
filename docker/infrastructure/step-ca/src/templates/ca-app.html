<!-- Certificate Authority Application Template -->

<!-- Hero Section -->
<div class="hero-section" style="
    background: linear-gradient(135deg, var(--wa-color-success-600) 0%, var(--wa-color-success-800) 100%);
    color: white;
    padding: var(--wa-space-2xl);
    text-align: center;
    margin: calc(var(--wa-space-xl) * -1) calc(var(--wa-space-xl) * -1) var(--wa-space-xl);
">
    <div class="hero-title" style="font-size: var(--wa-font-size-3xl); font-weight: var(--wa-font-weight-bold); margin-bottom: var(--wa-space-m);">
        <wa-icon name="shield-check" style="margin-right: var(--wa-space-s);"></wa-icon>
        DangerPrep Certificate Authority
    </div>
    <div class="hero-subtitle" style="font-size: var(--wa-font-size-lg); opacity: 0.9;">
        Secure SSL/TLS certificate management for emergency infrastructure
    </div>
</div>

<!-- Quick Actions -->
<div class="quick-actions" style="
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--wa-space-l);
    margin-bottom: var(--wa-space-2xl);
">
    <wa-card>
        <div class="wa-stack wa-gap-md" style="text-align: center;">
            <wa-icon name="download" style="font-size: 3rem; color: var(--wa-color-success-600);"></wa-icon>
            <h3 class="wa-heading-m">Download Root Certificate</h3>
            <p class="wa-body-s">Install the root CA certificate to trust DangerPrep services</p>
            <div class="wa-cluster wa-gap-sm">
                <wa-button href="/root-ca.crt" variant="success" size="small">
                    <wa-icon slot="start" name="download"></wa-icon>
                    Download .crt
                </wa-button>
                <wa-button href="/root-ca.pem" variant="success" appearance="outlined" size="small">
                    <wa-icon slot="start" name="download"></wa-icon>
                    Download .pem
                </wa-button>
            </div>
        </div>
    </wa-card>

    <wa-card>
        <div class="wa-stack wa-gap-md" style="text-align: center;">
            <wa-icon name="mobile" style="font-size: 3rem; color: var(--wa-color-brand-600);"></wa-icon>
            <h3 class="wa-heading-m">Mobile Device Profiles</h3>
            <p class="wa-body-s">Install configuration profiles for automatic certificate trust</p>
            <div class="wa-cluster wa-gap-sm">
                <wa-button href="/profiles/ios.mobileconfig" variant="brand" size="small">
                    <wa-icon slot="start" name="mobile"></wa-icon>
                    iOS Profile
                </wa-button>
                <wa-button href="/profiles/macos.mobileconfig" variant="brand" appearance="outlined" size="small">
                    <wa-icon slot="start" name="laptop"></wa-icon>
                    macOS Profile
                </wa-button>
            </div>
        </div>
    </wa-card>

    <wa-card>
        <div class="wa-stack wa-gap-md" style="text-align: center;">
            <wa-icon name="terminal" style="font-size: 3rem; color: var(--wa-color-warning-600);"></wa-icon>
            <h3 class="wa-heading-m">ACME Integration</h3>
            <p class="wa-body-s">Automatic certificate provisioning for services</p>
            <div class="wa-cluster wa-gap-sm">
                <wa-button href="/acme/directory" variant="warning" size="small">
                    <wa-icon slot="start" name="link"></wa-icon>
                    ACME Directory
                </wa-button>
                <wa-button href="#acme-docs" variant="warning" appearance="outlined" size="small">
                    <wa-icon slot="start" name="book"></wa-icon>
                    Documentation
                </wa-button>
            </div>
        </div>
    </wa-card>
</div>

<!-- Certificate Authority Information -->
<div class="ca-info-section">
    <h2 class="wa-heading-l" style="margin-bottom: var(--wa-space-l);">Certificate Authority Information</h2>
    
    <div class="wa-grid" style="--wa-grid-columns: 1fr 1fr; gap: var(--wa-space-l); margin-bottom: var(--wa-space-2xl);">
        <wa-card>
            <div class="wa-stack wa-gap-md">
                <h3 class="wa-heading-m">
                    <wa-icon name="info-circle" style="margin-right: var(--wa-space-xs);"></wa-icon>
                    CA Details
                </h3>
                <div class="wa-stack wa-gap-sm">
                    <div class="wa-flank wa-gap-sm">
                        <strong class="wa-body-s">Name:</strong>
                        <span class="wa-body-s">{{caName}}</span>
                    </div>
                    <div class="wa-flank wa-gap-sm">
                        <strong class="wa-body-s">Organization:</strong>
                        <span class="wa-body-s">{{caOrganization}}</span>
                    </div>
                    <div class="wa-flank wa-gap-sm">
                        <strong class="wa-body-s">Country:</strong>
                        <span class="wa-body-s">{{caCountry}}</span>
                    </div>
                    <div class="wa-flank wa-gap-sm">
                        <strong class="wa-body-s">Locality:</strong>
                        <span class="wa-body-s">{{caLocality}}</span>
                    </div>
                    {{#if caUrl}}
                    <div class="wa-flank wa-gap-sm">
                        <strong class="wa-body-s">ACME URL:</strong>
                        <code class="wa-body-s">{{caUrl}}</code>
                    </div>
                    {{/if}}
                </div>
            </div>
        </wa-card>

        <wa-card>
            <div class="wa-stack wa-gap-md">
                <h3 class="wa-heading-m">
                    <wa-icon name="shield-check" style="margin-right: var(--wa-space-xs);"></wa-icon>
                    Certificate Status
                </h3>
                <div class="wa-stack wa-gap-sm">
                    <div class="wa-flank wa-gap-sm">
                        <strong class="wa-body-s">Root Certificate:</strong>
                        <wa-badge variant="{{#if rootCertExists}}success{{else}}danger{{/if}}" size="small">
                            {{#if rootCertExists}}Available{{else}}Not Found{{/if}}
                        </wa-badge>
                    </div>
                    <div class="wa-flank wa-gap-sm">
                        <strong class="wa-body-s">ACME Service:</strong>
                        <wa-badge variant="{{#if acmeEnabled}}success{{else}}warning{{/if}}" size="small">
                            {{#if acmeEnabled}}Enabled{{else}}Disabled{{/if}}
                        </wa-badge>
                    </div>
                    {{#if certExpiry}}
                    <div class="wa-flank wa-gap-sm">
                        <strong class="wa-body-s">Expires:</strong>
                        <span class="wa-body-s">{{certExpiry}}</span>
                    </div>
                    {{/if}}
                </div>
            </div>
        </wa-card>
    </div>
</div>

<!-- Installation Instructions -->
<div class="installation-section">
    <h2 class="wa-heading-l" style="margin-bottom: var(--wa-space-l);">Installation Instructions</h2>
    
    <wa-tab-group>
        <wa-tab slot="nav" panel="manual">Manual Installation</wa-tab>
        <wa-tab slot="nav" panel="mobile">Mobile Devices</wa-tab>
        <wa-tab slot="nav" panel="acme">ACME/Automated</wa-tab>
        
        <wa-tab-panel name="manual">
            <div class="wa-stack wa-gap-lg">
                <wa-card>
                    <h4 class="wa-heading-s">Linux/macOS</h4>
                    <pre class="wa-body-s" style="background: var(--wa-color-neutral-100); padding: var(--wa-space-m); border-radius: var(--wa-border-radius-s); overflow-x: auto;"><code># Download and install root certificate
curl -o dangerprep-ca.crt https://ca.danger/root-ca.crt

# Add to system trust store (Ubuntu/Debian)
sudo cp dangerprep-ca.crt /usr/local/share/ca-certificates/
sudo update-ca-certificates

# Add to system trust store (macOS)
sudo security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain dangerprep-ca.crt</code></pre>
                </wa-card>
                
                <wa-card>
                    <h4 class="wa-heading-s">Windows</h4>
                    <pre class="wa-body-s" style="background: var(--wa-color-neutral-100); padding: var(--wa-space-m); border-radius: var(--wa-border-radius-s); overflow-x: auto;"><code># Download certificate and import to Trusted Root Certification Authorities
# 1. Download https://ca.danger/root-ca.crt
# 2. Right-click the .crt file and select "Install Certificate"
# 3. Choose "Local Machine" and "Trusted Root Certification Authorities"</code></pre>
                </wa-card>
            </div>
        </wa-tab-panel>
        
        <wa-tab-panel name="mobile">
            <div class="wa-stack wa-gap-lg">
                <wa-card>
                    <h4 class="wa-heading-s">iOS/iPadOS</h4>
                    <ol class="wa-body-s">
                        <li>Download the <a href="/profiles/ios.mobileconfig">iOS configuration profile</a></li>
                        <li>Open Settings → General → VPN & Device Management</li>
                        <li>Tap the DangerPrep profile and install it</li>
                        <li>Go to Settings → General → About → Certificate Trust Settings</li>
                        <li>Enable full trust for the DangerPrep CA certificate</li>
                    </ol>
                </wa-card>
                
                <wa-card>
                    <h4 class="wa-heading-s">macOS</h4>
                    <ol class="wa-body-s">
                        <li>Download the <a href="/profiles/macos.mobileconfig">macOS configuration profile</a></li>
                        <li>Double-click to install the profile</li>
                        <li>Open System Preferences → Profiles</li>
                        <li>Verify the DangerPrep profile is installed</li>
                    </ol>
                </wa-card>
            </div>
        </wa-tab-panel>
        
        <wa-tab-panel name="acme" id="acme-docs">
            <div class="wa-stack wa-gap-lg">
                <wa-card>
                    <h4 class="wa-heading-s">Traefik Configuration</h4>
                    <pre class="wa-body-s" style="background: var(--wa-color-neutral-100); padding: var(--wa-space-m); border-radius: var(--wa-border-radius-s); overflow-x: auto;"><code># traefik.yml
certificatesResolvers:
  step-ca:
    acme:
      caServer: {{caUrl}}/acme/acme/directory
      email: admin@danger.local
      storage: /data/acme.json
      httpChallenge:
        entryPoint: web</code></pre>
                </wa-card>
                
                <wa-card>
                    <h4 class="wa-heading-s">Certbot</h4>
                    <pre class="wa-body-s" style="background: var(--wa-color-neutral-100); padding: var(--wa-space-m); border-radius: var(--wa-border-radius-s); overflow-x: auto;"><code># Request certificate using certbot
certbot certonly \
  --server {{caUrl}}/acme/acme/directory \
  --standalone \
  -d example.danger</code></pre>
                </wa-card>
            </div>
        </wa-tab-panel>
    </wa-tab-group>
</div>

<!-- API Endpoints -->
<div class="api-section" style="margin-top: var(--wa-space-2xl);">
    <h2 class="wa-heading-l" style="margin-bottom: var(--wa-space-l);">API Endpoints</h2>
    
    <div class="wa-grid" style="--wa-grid-columns: 1; gap: var(--wa-space-m);">
        <wa-card appearance="outlined">
            <div class="wa-stack wa-gap-sm">
                <div class="wa-flank wa-gap-sm">
                    <code class="wa-heading-s">GET /root-ca.crt</code>
                    <wa-badge variant="success" size="small">GET</wa-badge>
                </div>
                <p class="wa-body-s">Download root CA certificate in CRT format</p>
            </div>
        </wa-card>
        
        <wa-card appearance="outlined">
            <div class="wa-stack wa-gap-sm">
                <div class="wa-flank wa-gap-sm">
                    <code class="wa-heading-s">GET /root-ca.pem</code>
                    <wa-badge variant="success" size="small">GET</wa-badge>
                </div>
                <p class="wa-body-s">Download root CA certificate in PEM format</p>
            </div>
        </wa-card>
        
        <wa-card appearance="outlined">
            <div class="wa-stack wa-gap-sm">
                <div class="wa-flank wa-gap-sm">
                    <code class="wa-heading-s">GET /acme/directory</code>
                    <wa-badge variant="success" size="small">GET</wa-badge>
                </div>
                <p class="wa-body-s">ACME directory endpoint for automatic certificate provisioning</p>
            </div>
        </wa-card>
        
        <wa-card appearance="outlined">
            <div class="wa-stack wa-gap-sm">
                <div class="wa-flank wa-gap-sm">
                    <code class="wa-heading-s">GET /profiles/ios.mobileconfig</code>
                    <wa-badge variant="success" size="small">GET</wa-badge>
                </div>
                <p class="wa-body-s">iOS/iPadOS configuration profile for automatic CA trust</p>
            </div>
        </wa-card>
        
        <wa-card appearance="outlined">
            <div class="wa-stack wa-gap-sm">
                <div class="wa-flank wa-gap-sm">
                    <code class="wa-heading-s">GET /profiles/macos.mobileconfig</code>
                    <wa-badge variant="success" size="small">GET</wa-badge>
                </div>
                <p class="wa-body-s">macOS configuration profile for automatic CA trust</p>
            </div>
        </wa-card>
    </div>
</div>
