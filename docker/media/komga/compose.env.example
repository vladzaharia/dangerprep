# =============================================================================
# KOMGA ENVIRONMENT VARIABLES - COMPREHENSIVE EXAMPLE
# =============================================================================
# Complete configuration options for Komga comic/manga server
# Reference: https://komga.org/docs/installation/configuration/

# -----------------------------------------------------------------------------
# System Configuration
# -----------------------------------------------------------------------------
# Installation Root Path
INSTALL_ROOT=${DANGERPREP_INSTALL_ROOT:-/opt/dangerprep}

# Timezone Configuration
TZ={{TZ}}

# User/Group IDs for file permissions (useful for Docker)
PUID=1337
PGID=1337

# -----------------------------------------------------------------------------
# Core Komga Configuration
# -----------------------------------------------------------------------------
# Configuration directory (where Komga stores its data)
KOMGA_CONFIGDIR=/config

# Server port (default: 25600)
SERVER_PORT=25600

# Base URL for reverse proxy setups
SERVER_SERVLET_CONTEXTPATH=/komga

# Session timeout (examples: 30m, 24h, 7d)
SERVER_SERVLET_SESSION_TIMEOUT=30m

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
# Main database file path (SQLite)
KOMGA_DATABASE_FILE=/config/database.sqlite

# Tasks database file path (SQLite)
KOMGA_TASKSDB_FILE=/config/tasks.sqlite

# Disable local filesystem check (not recommended)
KOMGA_DATABASE_CHECKLOCALFILESYSTEM=true
KOMGA_TASKSDB_CHECKLOCALFILESYSTEM=true

# Database fine-tuning
KOMGA_DATABASE_BUSYTIMEOUT=30s
KOMGA_DATABASE_JOURNALMODE=wal
KOMGA_DATABASE_POOLSIZE=1
KOMGA_DATABASE_MAXPOOLSIZE=8

# -----------------------------------------------------------------------------
# Library Management
# -----------------------------------------------------------------------------
# Scan libraries on startup
KOMGA_LIBRARIES_SCAN_STARTUP=true

# Automatic library scanning schedule (cron format)
KOMGA_LIBRARIES_SCAN_CRON=0 */6 * * *

# Enable real-time library monitoring
KOMGA_LIBRARIES_SCAN_REALTIME=false

# Library scan timeout (in seconds)
KOMGA_LIBRARIES_SCAN_TIMEOUT=3600

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------
# Allowed origins for CORS (comma-separated)
KOMGA_CORS_ALLOWEDORIGINS=http://localhost:3000,http://localhost:8080

# -----------------------------------------------------------------------------
# Authentication Configuration
# -----------------------------------------------------------------------------
# Enable OAuth2 account creation
KOMGA_OAUTH2ACCOUNTCREATION=false

# Enable OIDC email verification
KOMGA_OIDCEMAILVERIFICATION=true

# Session configuration
KOMGA_SESSION_TIMEOUT=7d
KOMGA_SESSION_REMEMBER_ME=true

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------
# Log file name and path
LOGGING_FILE_NAME=/config/logs/komga.log

# Log level (TRACE, DEBUG, INFO, WARN, ERROR)
LOGGING_LEVEL_ROOT=INFO
LOGGING_LEVEL_ORG_GOTSON_KOMGA=INFO

# Log pattern
LOGGING_PATTERN_CONSOLE=%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
LOGGING_PATTERN_FILE=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# -----------------------------------------------------------------------------
# Performance Configuration
# -----------------------------------------------------------------------------
# JVM memory settings (set in Docker compose or startup script)
JAVA_OPTS=-Xmx2g -Xms512m

# Thumbnail generation settings
KOMGA_THUMBNAIL_SIZE=300
KOMGA_THUMBNAIL_FORMAT=jpeg
KOMGA_THUMBNAIL_QUALITY=0.95

# Page streaming settings
KOMGA_PAGE_STREAMING_ENABLED=true
KOMGA_PAGE_HASHING_ENABLED=true

# -----------------------------------------------------------------------------
# Content Processing
# -----------------------------------------------------------------------------
# Enable content analysis
KOMGA_ANALYSIS_ENABLED=true

# Content analysis timeout (in seconds)
KOMGA_ANALYSIS_TIMEOUT=300

# Enable metadata extraction
KOMGA_METADATA_EXTRACTION_ENABLED=true

# Enable cover extraction
KOMGA_COVER_EXTRACTION_ENABLED=true

# -----------------------------------------------------------------------------
# API Configuration
# -----------------------------------------------------------------------------
# Enable API documentation (Swagger)
KOMGA_API_DOCS_ENABLED=true

# API rate limiting
KOMGA_API_RATELIMIT_ENABLED=false
KOMGA_API_RATELIMIT_REQUESTS=100
KOMGA_API_RATELIMIT_DURATION=1m

# -----------------------------------------------------------------------------
# Security Configuration
# -----------------------------------------------------------------------------
# Enable HTTPS
SERVER_SSL_ENABLED=false
SERVER_SSL_KEYSTORE=/config/keystore.p12

# GENERATE[16]: SSL keystore password
SERVER_SSL_KEYSTOREPASSWORD=change_me_keystore_password
SERVER_SSL_KEYSTORETYPE=PKCS12

# Security headers
KOMGA_SECURITY_HEADERS_ENABLED=true
KOMGA_SECURITY_HEADERS_FRAME_OPTIONS=DENY
KOMGA_SECURITY_HEADERS_CONTENT_TYPE_OPTIONS=nosniff

# -----------------------------------------------------------------------------
# Integration Configuration
# -----------------------------------------------------------------------------
# Enable webhooks
KOMGA_WEBHOOKS_ENABLED=false

# Webhook URLs (comma-separated)
KOMGA_WEBHOOKS_URLS=http://localhost:8080/webhook

# Enable metrics endpoint
KOMGA_METRICS_ENABLED=false

# Metrics endpoint path
KOMGA_METRICS_PATH=/actuator/metrics

# -----------------------------------------------------------------------------
# Advanced Configuration
# -----------------------------------------------------------------------------
# Enable experimental features
KOMGA_EXPERIMENTAL_ENABLED=false

# Custom CSS path
KOMGA_CUSTOM_CSS_PATH=/config/custom.css

# Custom JavaScript path
KOMGA_CUSTOM_JS_PATH=/config/custom.js

# Enable development mode
KOMGA_DEV_MODE=false

# -----------------------------------------------------------------------------
# Backup Configuration
# -----------------------------------------------------------------------------
# Enable automatic backups
KOMGA_BACKUP_ENABLED=false

# Backup schedule (cron format)
KOMGA_BACKUP_SCHEDULE=0 2 * * *

# Backup retention days
KOMGA_BACKUP_RETENTION_DAYS=7

# Backup path
KOMGA_BACKUP_PATH=/config/backups
